size = 1.2) +
labs(x = "reb",
y = "stl") +
theme_bw()
#existe uma correlaÃ§Ã£o positiva entre rebotes e roubos, menor que a anterior
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = reb, y = blk),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = reb, y = blk),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "reb",
y = "blk") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = reb, y = pts),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = reb, y = pts),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "reb",
y = "pts") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = reb, y = fg3m),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = reb, y = fg3m),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "reb",
y = "fg3m") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = reb, y = total_mins),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = reb, y = total_mins),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "reb",
y = "total_mins") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = reb, y = net_rating),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = reb, y = net_rating),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "reb",
y = "net_rating") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = ast, y = stl),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = ast, y = stl),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "ast",
y = "stl") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = ast, y = blk),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = ast, y = blk),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "ast",
y = "blk") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = ast, y = pts),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = ast, y = pts),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "ast",
y = "pts") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = ast, y = fg3m),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = ast, y = fg3m),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "ast",
y = "fg3m") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = ast, y = total_mins),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = ast, y = total_mins),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "ast",
y = "total_mins") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = ast, y = net_rating),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = ast, y = net_rating),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "ast",
y = "net_rating") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = stl, y = blk),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = stl, y = blk),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "stl",
y = "blk") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = stl, y = pts),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = stl, y = pts),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "stl",
y = "pts") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = stl, y = fg3m),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = stl, y = fg3m),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "stl",
y = "fg3m") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = stl, y = total_mins),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = stl, y = total_mins),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "stl",
y = "total_mins") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = stl, y = net_rating),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = stl, y = net_rating),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "stl",
y = "net_rating") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = blk, y = pts),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = blk, y = pts),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "blk",
y = "pts") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = blk, y = fg3m),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = blk, y = fg3m),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "blk",
y = "fg3m") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = blk, y = total_mins),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = blk, y = total_mins),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "blk",
y = "total_mins") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = blk, y = net_rating),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = blk, y = net_rating),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "blk",
y = "net_rating") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = pts, y = fg3m),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = pts, y = fg3m),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "pts",
y = "fg3m") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = pts, y = total_mins),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = pts, y = total_mins),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "pts",
y = "total_mins") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = pts, y = net_rating),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = pts, y = net_rating),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "pts",
y = "net_rating") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = fg3m, y = total_mins),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = fg3m, y = total_mins),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "fg3m",
y = "total_mins") +
theme_bw()
nba_rookies_2022 %>%
ggplot() +
geom_point(aes(x = fg3m, y = net_rating),
color = "dodgerblue4",
size = 2)  +
geom_smooth(aes(x = fg3m, y = net_rating),
color = "darkgoldenrod3",
method = "lm",
formula = y ~ x,
se = FALSE,
size = 1.2) +
labs(x = "fg3m",
y = "net_rating") +
theme_bw()
#salvando a matriz de correlaÃ§Ãµes
rho <- cor(nba_rookies_2022[,2:10])
chart.Correlation(nba_rookies_2022[,2:10])
# Construindo um mapa de calor a partir das correlaÃ§Ãµes
rho %>%
melt() %>%
ggplot() +
geom_tile(aes(x = Var1, y = Var2, fill = value)) +
geom_text(aes(x = Var1, y = Var2, label = round(x = value, digits = 3)),
size = 4) +
labs(x = NULL,
y = NULL,
fill = "CorrelaÃ§Ãµes") +
scale_fill_gradient2(low = "dodgerblue4",
mid = "white",
high = "brown4",
midpoint = 0) +
theme(panel.background = element_rect("white"),
panel.grid = element_line("grey95"),
panel.border = element_rect(NA),
legend.position = "bottom",
axis.text.x = element_text(angle = 0))
#realizando o teste de esfericidade batlett para conferir se o pca Ã© aplicÃ¡vel
cortest.bartlett(R = rho)
nba_rookies_2022_std <- nba_rookies_2022 %>%
column_to_rownames("player_name") %>%
scale() %>%
data.frame()
afpc <- prcomp(nba_rookies_2022_std)
summary(afpc)
data.frame(afpc$rotation) %>%
mutate(var = names(nba_rookies_2022[2:10])) %>%
melt(id.vars = "var") %>%
mutate(var = factor(var)) %>%
ggplot(aes(x = var, y = value, fill = var)) +
geom_bar(stat = "identity", color = "black") +
facet_wrap(~variable) +
labs(x = NULL, y = NULL, fill = "Legenda:") +
scale_fill_viridis_d() +
theme_bw()
#vamos analisar o scree plot
ggplotly(
fviz_eig(X = afpc,
ggtheme = theme_bw(),
barcolor = "black",
barfill = "dodgerblue4",
linecolor = "darkgoldenrod3")
)
k <- sum((afpc$sdev ^ 2) > 1) #nÃºmero de variÃ¡veis presentes na base de dados
k
#visualizando as cargas fatoriais
cargas_fatoriais <- afpc$rotation[, 1:k] %*% diag(afpc$sdev[1:k])
cargas_fatoriais
data.frame(cargas_fatoriais) %>%
rename(F1 = X1,
F2 = X2,
F3 = X3) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
#visualizando as comunalidades
data.frame(rowSums(cargas_fatoriais ^ 2)) %>%
rename(comunalidades = 1) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
# RelatÃ³rio das cargas fatoriais e das comunalidades
data.frame(cargas_fatoriais) %>%
rename(F1 = X1,
F2 = X2,
F3 = X3) %>%
mutate(Comunalidades = rowSums(cargas_fatoriais ^ 2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
# Plotagem das Cargas Fatoriais COM 2 FATORES
data.frame(cargas_fatoriais) %>%
ggplot(aes(x = X1, y = X2)) +
geom_point(color = "dodgerblue4") +
geom_hline(yintercept = 0, color = "darkgoldenrod3", linetype = "dashed") +
geom_vline(xintercept = 0, color = "darkgoldenrod3", linetype = "dashed") +
geom_text_repel(label = row.names(cargas_fatoriais)) +
labs(x = paste("F1", paste0("(",
round(summary(afpc)$importance[2,1] * 100,
digits = 2),
"%)")),
y = paste("F2", paste0("(",
round(summary(afpc)$importance[2,2] * 100,
digits = 2),
"%)"))) +
theme_bw()
#Plotagem das cargas fatoriais incluindo o F3
data.frame(cargas_fatoriais) %>%
ggplot(aes(x = X1, y = X3)) +
geom_point(color = "dodgerblue4") +
geom_hline(yintercept = 0, color = "darkgoldenrod3", linetype = "dashed") +
geom_vline(xintercept = 0, color = "darkgoldenrod3", linetype = "dashed") +
geom_text_repel(label = row.names(cargas_fatoriais)) +
labs(x = paste("F1", paste0("(",
round(summary(afpc)$importance[2,1] * 100,
digits = 2),
"%)")),
y = paste("F3", paste0("(",
round(summary(afpc)$importance[2,2] * 100,
digits = 2),
"%)"))) +
theme_bw()
# Scores Fatoriais
scores_fatoriais <- t(afpc$rotation)/afpc$sdev
colnames(scores_fatoriais) <- colnames(nba_rookies_2022_std)
scores_fatoriais %>%
t() %>%
data.frame() %>%
rename(PC1 = 1,
PC2 = 2,
PC3 = 3) %>%
select(PC1, PC2, PC3) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
# A seguir, vamos criar um objeto que servirÃ¡ como um receptÃ¡culo para os
# k fatores (36, no caso estudado) a serem calculados:
fatores <- list()
# Agora, utilizaremos a funÃ§Ã£o for
for(i in 1:nrow(scores_fatoriais)){
fatores[[i]] <- rowSums(x = sweep(x = nba_rookies_2022_std,
MARGIN = 2,
STATS = scores_fatoriais[i,],
FUN = `*`))
}
# Feito isso, para fins didÃ¡ticos, vamos transformar o objeto fatores em um
# data frame para melhor visualizaÃ§Ã£o e assimiliaÃ§Ã£o de seu conteÃºdo:
fatores_df <- data.frame((sapply(X = fatores, FUN = c)))
fatores_df
#como iremos utilizar apenas 3 fatores, iremos excluir os outros
manter <- c('X1', 'X2', 'X3')
fatores_df <- fatores_df[manter]
fatores_df %>%
rename(F1 = X1,
F2 = X2,
F3 = X3) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
# Combinando a base original 'nba_rookies_2022' com o objeto 'fatores_df':
nba_rookies_2022_final <-  cbind(nba_rookies_2022,
fatores_df) %>%
rename(F1 = X1,
F2 = X2,
F3 = X3)
# Calculando as correlaÃ§Ãµes entre as variÃ¡veis e originais e os fatores
correlacoes_entre_fatores <- cor(nba_rookies_2022_final[,2:13])
